<include file="Public:nav"/>

    <div class="row aerousel">
        <ol class="breadcrumb">
            <li><a href="/index.html">网站首页</a></li>
            <li><a href="/album.html">相册</a></li>
            <li class="active">{$albums.al_name}</li>
        </ol>
    <div class="col-md-8 row-l">
        <div class="row album-look">
        <div class="main"> 
  <!--弹出层开始-->
  <div class="bodymodal"></div>
  <!--播放到第一张图的提示-->
  <div class="firsttop">
    <div class="firsttop_left"> 
    
    </div>
    <div class="firsttop_right">
      <div class="close2"> <a class="closebtn1" title="关闭" href="javascript:void(0)"></a> </div>
      <div class="replay">
        <h2 id="div-end-h2"> 已到第一张图片了。 </h2>
        <p> <a class="replaybtn1" href="javascript:;">重新播放</a> </p>
      </div>
      <div class="pictwo">
        <ul>
          <li><empty name="up.al_id"><else />
        <div class="picshowlist_left">
          <div class="picleftimg"> <a href="{:U("/album-".$up['al_id'])}" title="{$up.al_name}" target="_blank"><img src="{$up.al_img}" alt="{$up.al_name}" /></a> </div>
          <a title='{$up.al_name}' href="{:U("/album-".$up['al_id'])}">&nbsp;{$up.al_name}</a>
        </div></empty>
          </li>          
          <li>        <empty name="down.al_id"><else />
        <div class="picshowlist_right" >
          <div class="picleftimg"> <a href="{:U("/album-".$down['al_id'])}" title="{$down.al_name}" target="_blank"><img src="{$down.al_img}" alt="{$down.al_name}" /></a> </div>
          <a title='{$down.al_name}' href="{:U("/album-".$down['al_id'])}">&nbsp;{$down.al_name}</a>
        </div></empty>
          </li>
        </ul>
      </div>
      <div class="returnbtn"> <a href="{:U('/album')}">返回相册首页</a> </div>
    </div>
  </div>
  <!--播放到最后一张图的提示-->
  <div class="endtop">
    <div class="firsttop_left"> 

    </div>
    <div class="firsttop_right">
      <div class="close2"> <a class="closebtn2" title="关闭" href="javascript:void(0)"></a> </div>
      <div class="replay">
        <h2 id="H1"> 已到最后一张图片了。 </h2>
        <p> <a class="replaybtn2" href="javascript:;">重新播放</a> </p>
      </div>
      <div class="pictwo">
        <ul>
          <li><empty name="up.al_id"><else />
        <div class="picshowlist_left">
          <div class="picleftimg"> <a href="{:U("/album-".$up['al_id'])}" title="{$up.al_name}" target="_blank"><img src="{$up.al_img}" alt="{$up.al_name}" /></a> </div>
          <a title='{$up.al_name}' href="{:U("/album-".$up['al_id'])}">&nbsp;{$up.al_name}</a>
        </div></empty>
          </li>          
          <li>
          <empty name="down.al_id"><else />
        <div class="picshowlist_right" >
          <div class="picleftimg"> <a href="{:U("/album-".$down['al_id'])}" title="{$down.al_name}" target="_blank"><img src="{$down.al_img}" alt="{$down.al_name}" /></a> </div>
          <a title='{$down.al_name}' href="{:U("/album-".$down['al_id'])}">&nbsp;{$down.al_name}</a>
        </div>
        </empty>
          </li>
        </ul>
      </div>
      <div class="returnbtn"> <a href="{:U('/album')}">返回图库首页</a> </div>
    </div>
  </div>
  <!--弹出层结束--> 
  <!--图片特效内容开始-->
  <div class="piccontext">
  <h2>{$albums.al_name}</h2>
    <div class="source">
      <div class="source_left" id="loadButton"><span>更新{$albums.al_time|getTime}</span> </div>
      <div class="source_right">
        <div class="support"> 支持<img src="__IMG__/jiantou1.jpg" />键翻阅图片 </div>
        <span>|</span><a href="#myspeak" class="spell">我有话说</a><span>|</span><a href="javascript:;" class="list">列表查看</a> </div>
      <div class="source_right1"> <a href="javascript:;" class="gaoqing">高清查看</a> </div>
    </div>
    <!--大图展示-->
    <div class="picshow">
      <div class="picshowtop">
          <a href="#"><img src="" alt="" id="pic1" curindex="0" /></a>
          <a id="preArrow" href="javascript:void(0)" class="contextDiv" title="上一张"><span id="preArrow_A"></span></a>
          <a id="nextArrow" href="javascript:void(0)" class="contextDiv" title="下一张"><span id="nextArrow_A"></span></a>
      </div>
      <div class="picshowtxt">
        <div class="picshowtxt_left"><span>1</span>/<i>{$p_count}</i></div>
        <div class="picshowtxt_right"></div>
      </div>
      <div class="picshowlist"> 
        <!--上一条图库-->
        <empty name="up.al_id"><else />
        <div class="picshowlist_left">
          <div class="picleftimg"> <a href="{:U("/album-".$up['al_id'])}" title="{$up.al_name}" target="_blank"><img src="{$up.al_img}" alt="{$up.al_name}" /></a> </div>
          <div class="piclefttxt"><a title='{$up.al_name}' href="{:U("/album-".$up['al_id'])}">&nbsp;{$up.al_name}</a></div>
        </div></empty>
        <div class="picshowlist_mid">
          <div class="picmidleft"> <a href="javascript:void(0)" id="preArrow_B"><img src="__IMG__/left1.jpg" alt="上一个" /></a> </div>
          <div class="picmidmid">
            <ul>
            <volist name="pictureList" id="v" >
              <li> <a href="javascript:void(0);"><img src="{$v.p_thumb}" alt="" bigimg="{$v.p_img}" text="{$v.p_remark}" /></a>
              </li>
              </volist>
<!--               <li> <a href="javascript:void(0);"><img src="__IMG__/2.jpg" alt="" bigimg="__IMG__/2.jpg" text="《古剑》小师妹迪丽热巴清新写真宛若小仙女" /></a></li> -->
            </ul>
          </div>
          <div class="picmidright"> <a href="javascript:void(0)" id="nextArrow_B"><img src="__IMG__/right1.jpg" alt="下一个" /></a> </div>
        </div>
        <!--下一张图库新闻-->
        <empty name="down.al_id"><else />
        <div class="picshowlist_right" >
          <div class="picleftimg"> <a href="{:U("/album-".$down['al_id'])}" title="{$down.al_name}" target="_blank"><img src="{$down.al_img}" alt="{$down.al_name}" /></a> </div>
          <div class="piclefttxt"><a title='{$down.al_name}' href="{:U("/album-".$down['al_id'])}">&nbsp;{$down.al_name}</a></div>
        </div></empty>
      </div>
    </div>
    
    <!--列表展示-->
    <div class="piclistshow">
      <ul>
      <volist name="pictureList" id="v" key="k" >
        <li>
          <div class="picimg"><img src="{$v.p_thumb}" alt="" /></div>
          <div class="pictxt">
            <h3>{$v.p_remark}<span>({$k}/{$p_count})</span></h3>
          </div>
        </li>
        </volist>
<!--         <li>
          <div class="picimg"><img src="__IMG__/2.jpg" alt="" /></div>
          <div class="pictxt">
            <h3>《古剑》小师妹迪丽热巴清新写真宛若小仙女<span>(2/12)</span></h3>
          </div>
        </li> -->
      </ul>
    </div>
    <div class="description"><p>{$albums.al_remark}</p></div>
  </div>
</div>
<!--        <volist name="pictureList" id="v" >
          <div class="col-xs-6 col-md-3">
          <a class="fancybox-buttons thumbnail preview" data-fancybox-group="button" href="{$v.p_img}"><img src="{$v.p_thumb}" alt="{$v.p_remark}" /></a>
          </div>
        </volist> -->
        </div>
        <div class="sider-box" id="myspeak">
    <volist name="al_content" id="vo">
    <div class="media connect">
    <div class="media-left">
        <notempty name="vo.ac_url">
        <a href="{$vo.alc_url}" target="_blank" rel="nofollow" title="浏览 {$vo.alc_name} 的网站?"><img class="media-object img-circle  img-50" src="{$vo.alc_img}" alt="{$vo.alc_name}"></a>
        <else />
        <img src="{$vo.alc_img}" class="media-object img-circle img-50" alt="{$vo.alc_name}"/>
        </notempty>
        </div>
        <div class="media-body">
            <div class="fool">#{$vo.alc_id}</div>
            <p class="media-heading"><a><span class="glyphicon glyphicon-user"></span></a>&nbsp;&nbsp;&nbsp;{$vo.alc_name}&nbsp;&nbsp;<a><span class="glyphicon glyphicon-time"></span></a>&nbsp;{$vo.alc_time|getTime}&nbsp;&nbsp;&nbsp;&nbsp;<a class="from">{$vo.alc_from}</a>&nbsp;&nbsp;&nbsp;&nbsp;<a><span class="glyphicon glyphicon-map-marker"></span></a>&nbsp;&nbsp;{$vo.ip}</p>
            <div class="connect-box"> {$vo.alc_content|reFace}</div>
            <notempty name="vo.alc_rtime">
            <hr class="content-hr" />
            <div class="media">
                <div class="media-left">
                <a><img class="media-object img-circle img-50" src="{$system.admin_img}" alt="{$vo.alc_rname}"></a>
                </div>
                <div class="media-body">
                <p class="media-heading"><a><span class="glyphicon glyphicon-king"></span></a>&nbsp;&nbsp;&nbsp;{$vo.alc_rname}&nbsp;&nbsp;<a><span class="glyphicon glyphicon-send"></span></a>&nbsp;{$vo.alc_rtime|date="m-d H:i",###}&nbsp;&nbsp;&nbsp;&nbsp;回复&nbsp;<a>@{$vo.alc_name}</a>&nbsp;中说到：</p>
                <div class="connect-box">{$vo.alc_rcontent|reFace}</div>
                </div>
            </div>  
            </notempty>
        </div>
    </div>
    <hr />
    </volist>
    
    <div class="home-from" >
        <div class="home-from-model"  data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">留下脚印</div>
        <div class="collapse" id="collapseExample">
            <div class="well">
            <div method="post" >
            <input id="alid" type="hidden" value="{$albums.al_id}" />
            <input id="alname" type="hidden"  value="{$albums.al_name}" />
            <input id="jump" type="hidden"  value="__SELF__" />
            <include file="Public:form"/>                   
            <div class="form-group home-from-box">
                <button class="btn btn-default btn-add-album" >提交</button>
            </div>
            </div>
            </div>
        </div>
    </div>
<script type="text/javascript">
window.setTimeout(show,300); 
function show() 
{ 
    $(".piclistshow li").hover(function() {
        $(this).css("background", "#FAFAFA")
    },
    function() {
        $(this).css("background", "white")
    });
    $(".piclistshow li").last().css("border-bottom", "none");
    $(".piclistshow li").each(function() {
        var curindex = $(this).index(".piclistshow li") + 1;
        if (curindex % 4 == 0) {
            $(this).css({
                "border-right": "none",
                "width": "190px"
            })
        }
    });
    $(document).keydown(function(event) {
        var key = event.keyCode;
        var firstdisplay = $(".firsttop").css("display");
        var enddisplay = $(".endtop").css("display");
        if (firstdisplay == "none" && enddisplay == "none") {
            if (key == 37) {
                preclick()
            } else {
                if (key == 39) {
                    nextclick()
                }
            }
        } else {
            if (key == 27) {
                $(".firsttop").css("display", "none");
                $(".bodymodal").css("display", "none");
                $(".endtop").css("display", "none")
            }
        }
    });
    /*
    本代码由素材家园收集并编辑整理;
    尊重他人劳动成果;
    转载请保留素材家园链接 - www.sucaijiayuan.com
    */
    var firstpic = $(".picmidmid ul li").first().find("img");
    var firstsrc = firstpic.attr("bigimg");
    var firsttxt = firstpic.attr("text");
    $("#pic1").attr("src", firstsrc);
    firstpic.addClass("selectpic");
    $(".picshowtxt_right").text(firsttxt);
    $("#preArrow").hover(function() {
        $("#preArrow_A").css("display", "block")
    },
    function() {
        $("#preArrow_A").css("display", "none")
    });
    $("#nextArrow").hover(function() {
        $("#nextArrow_A").css("display", "block")
    },
    function() {
        $("#nextArrow_A").css("display", "none")
    });
    var getli = $(".picmidmid ul li");
    function nextclick() {
        var currrentindex = parseFloat($("#pic1").attr("curindex"));
        var length = getli.length;
        if (currrentindex != (length - 1)) {
            var curli = getli.eq(currrentindex);
            if (currrentindex > 3) {
                getli.eq(currrentindex - 4).css("display", "none");
                getli.eq(currrentindex + 1).css("width", "95px").css("display", "block")
            }
            var curnextli = getli.eq(currrentindex + 1);
            var curnextsrc = curnextli.find("img").attr("bigimg");
            var curnexttxt = curnextli.find("img").attr("text");
            curli.find("img").removeClass("selectpic");
            curnextli.find("img").addClass("selectpic");
            $("#pic1").attr("src", curnextsrc);
            $("#pic1").attr("curindex", currrentindex + 1);
            $(".picshowtxt_right").text(curnexttxt);
            $(".picshowtxt_left span").text(currrentindex + 2)
        } else {
            $(".bodymodal").css("display", "block");
            $(".endtop").css("display", "block")
        }
    }
    $("#nextArrow_B").click(function() {
        nextclick()
    });
    $("#nextArrow").click(function() {
        nextclick()
    });
    function preclick() {
        var currrentindex = parseFloat($("#pic1").attr("curindex"));
        if (currrentindex != 0) {
            var curli = getli.eq(currrentindex);
            var length = getli.length;
            if (currrentindex <= (length - 5)) {
                getli.eq(currrentindex + 4).css("display", "none");
                getli.eq(currrentindex - 1).css("width", "116px").css("display", "block")
            }
            var curnextli = getli.eq(currrentindex - 1);
            var curnextsrc = curnextli.find("img").attr("bigimg");
            var curnexttxt = curnextli.find("img").attr("text");
            curli.find("img").removeClass("selectpic");
            curnextli.find("img").addClass("selectpic");
            $("#pic1").attr("src", curnextsrc);
            $(".picshowtxt_right").text(curnexttxt);
            $("#pic1").attr("curindex", currrentindex - 1);
            $(".picshowtxt_left span").text(currrentindex)
        } else {
            $(".bodymodal").css("display", "block");
            $(".firsttop").css("display", "block")
        }
    }
    $("#preArrow_B").click(function() {
        preclick()
    });
    $("#preArrow").click(function() {
        preclick()
    });
    getli.click(function() {
        var currentliindex = $(this).index(".picmidmid ul li");
        $(".picmidmid ul li img[class='selectpic']").removeClass("selectpic");
        var currentli = getli.eq(currentliindex);
        currentli.find("img").addClass("selectpic");
        var bigimgsrc = currentli.find("img").attr("bigimg");
        var curnexttxt = currentli.find("img").attr("text");
        $("#pic1").attr("src", bigimgsrc);
        $("#pic1").attr("curindex", currentliindex);
        $(".picshowtxt_right").text(curnexttxt);
        $(".picshowtxt_left span").text(currentliindex + 1)
    });
    $(".piclistshow li").click(function() {
        var curli = $(this).index(".piclistshow li");
        showgaoqing();
        $(".picmidmid ul li img[class='selectpic']").removeClass("selectpic");
        var currentli = getli.eq(curli);
        currentli.find("img").addClass("selectpic");
        var bigimgsrc = currentli.find("img").attr("bigimg");
        var curnexttxt = currentli.find("img").attr("text");
        $("#pic1").attr("src", bigimgsrc);
        $("#pic1").attr("curindex", curli);
        $(".picshowtxt_right").text(curnexttxt);
        $(".picshowtxt_left span").text(curli + 1);
        $(".picmidmid li").css("display", "block");
        if (curli >= 5) {
            var cha = curli - 5;
            for (var i = 0; i <= cha; i++) {
                getli.eq(i).css("display", "none")
            }
        }
    });
    setblock();
    function setblock() {
        var left = $(window).width() / 2 - 300;
        $(".firsttop").css("left", left);
        $(".endtop").css("left", left)
    }
    $(window).resize(function() {
        setblock()
    });
    $(".closebtn1").click(function() {
        $(".firsttop").css("display", "none");
        $(".bodymodal").css("display", "none")
    });
    $(".closebtn2").click(function() {
        $(".endtop").css("display", "none");
        $(".bodymodal").css("display", "none")
    });
    $(".replaybtn1").click(function() {
        $(".firsttop").css("display", "none");
        $(".bodymodal").css("display", "none")
    });
    $(".replaybtn2").click(function() {
        $(".endtop").css("display", "none");
        $(".bodymodal").css("display", "none");
        var curli = 0;
        showgaoqing();
        $(".picmidmid ul li img[class='selectpic']").removeClass("selectpic");
        var currentli = getli.eq(curli);
        currentli.find("img").addClass("selectpic");
        var bigimgsrc = currentli.find("img").attr("bigimg");
        var curnexttxt = currentli.find("img").attr("text");
        $("#pic1").attr("src", bigimgsrc);
        $("#pic1").attr("curindex", curli);
        $(".picshowtxt_right").text(curnexttxt);
        $(".picshowtxt_left span").text(curli + 1);
        $(".picmidmid li").css("display", "block");
        if (curli >= 5) {
            var cha = curli - 5;
            for (var i = 0; i <= cha; i++) {
                getli.eq(i).css("display", "none")
            }
        }
    });
    $(".list").click(function() {
        $(".picshow").css("display", "none");
        $(".piclistshow").css("display", "block");
        $(".source_right").css("display", "none");
        $(".source_right1").css("display", "block")
    });
    $(".gaoqing").click(function() {
        showgaoqing();
    });
    function showgaoqing() {
        $(".picshow").css("display", "block");
        $(".piclistshow").css("display", "none");
        $(".source_right").css("display", "block");
        $(".source_right1").css("display", "none")
    }
    $(".rank ul").first().css("display", "block");
    $(".ranknext").click(function() {
        var showindex = $(this).attr("show");
        var show = parseInt(showindex) + 1;
        var length = $(".rank ul").length;
        if (show < length) {
            $(".rank ul").eq(showindex).css("display", "none");
            $(".rank ul").eq(show).css("display", "block");
            $(this).attr("show", show);
            $(".rank ul").eq(show).find("img").lazyload()
        } else {
            $(".rank ul").css("display", "none");
            $(".rank ul").first().css("display", "block");
            $(this).attr("show", 0);
            $(".rank ul").first().find("img").lazyload()
        }
    });
    $(".tuijian").click(function() {
        var showindex = $(this).attr("show");
        var show = parseInt(showindex) + 1;
        var length = $(".rank1 ul").length;
        if (show < length) {
            $(".rank1 ul").eq(showindex).css("display", "none");
            $(".rank1 ul").eq(show).css("display", "block");
            $(this).attr("show", show)
        } else {
            $(".rank1 ul").css("display", "none");
            $(".rank1 ul").first().css("display", "block");
            $(this).attr("show", 0)
        }
    });
/*
本代码由素材家园收集并编辑整理;
尊重他人劳动成果;
转载请保留素材家园链接 - www.sucaijiayuan.com
*/

} 
    </script>

    <script type="text/javascript">
        //验证相册评论数据

        $('.btn-add-album').click(function(){

            $("#name").parent(".input-group").removeClass("has-error");

            $("#email").parent(".input-group").removeClass("has-warning");

            $("#email").parent(".input-group").removeClass("has-error");

            $("#content-text").parent(".form-group").removeClass("has-error");

            $("#txt_check").parent(".input-group").removeClass("has-error");

            var jump = $("#jump").val();

            var send = $("input[name='send']:checked").val();

            var rember = $("input[name='rember']:checked").val();

            var id = $("#alid").val();

            var alname = $("#alname").val();

            var name=$('#name').val();

            var alc_url =$('#url').val();

            var email=$('#email').val();

            var content_text=$('#content-text').val();

            var txt_check=$('#txt_check').val();

            if(!name){

                $("#name").parent(".input-group").addClass("has-error");

                return false;

            // }else if(!email){

            //  $("#email").parent(".input-group").addClass("has-warning");

            //  return false;

            // }else if(!/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(email)){

            //  $("#email").parent(".input-group").addClass("has-error");

            //  return false;

            // }else if(!content_text){

            //  $("#content-text").parent(".form-group").addClass("has-error");

            //  return false;

            // }else if(!txt_check){

            //  $("#txt_check").parent(".input-group").addClass("has-error");

            //  return false;

            }

            $(".btn-add-album").attr("disabled",true);

            var index = layer.load(1,{time: 5*1000});
            $.ajax({

                type:"post",

                url:"/index.php/home/Album/addAlbumContent",

                async:true,

                dataType:'json',

                data:{"alc_pid":id,"alname":alname,"alc_name":name,"alc_email":email,"alc_url":alc_url,"alc_content":content_text,"txt_check":txt_check,"send":send,"rember":rember},

                success:function(data){
                    layer.close(index);

                    if(data.att == 1){
                        layer.msg(data.msg, {icon: 5,
                            time: 2000, //20s后自动关闭
                        });

                        $("#txt_check").parent(".input-group").addClass("has-error");

                        $(".btn-add-album").removeAttr('disabled');

                        return false;                       

                    }else{

                        layer.msg(data.msg, {icon: 1,
                            time: 3000, //20s后自动关闭
                        }, function(){
                            window.location.href=jump;
                        });

                    }

                }

            });

        });
    </script>
    </div>
    </div>
    <include file="Public:sider"/>
